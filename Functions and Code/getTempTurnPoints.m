
function tempPoints = getTempTurnPoints(TempProtocolString)
% tPoints = getTempTurnPoints(tempList{ii})

% Use this to find temp points for new temp protocols:
% 
% figure; plot(smooth(T.temperature,2),'color', 'k')
% disp(expData.parameters.protocol)
% 
%

% disp(TempProtocolString)

% pull the appropriate start|end points:
switch TempProtocolString
    % =======================================
    case 'Hold25C'
        tempPoints.hold = [1000 159935];
        tempPoints.up =   [];
        tempPoints.down =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0; 
        tempPoints.threshLow = 24;
        tempPoints.threshHigh = 26;  
     case 'Hold23C'
        tempPoints.hold = [1000 159935];
        tempPoints.up =   [];
        tempPoints.down =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0; 
        tempPoints.threshLow = 22;
        tempPoints.threshHigh = 24;;  
    case 'Hold20C'
        tempPoints.hold = [1000 159935];
        tempPoints.up =   [];
        tempPoints.down =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0; 
        tempPoints.threshLow = 19;
        tempPoints.threshHigh = 21;
    
    % =======================================
    case 'linear_ramp_F_25-17'
        tempPoints.hold = [2385 18007;...
                           23843 38180;...
                           44143 58265];
        tempPoints.down = [18008 20989;...
                           38181 41132;...
                           58266 61201];
        tempPoints.up =   [20990 23842;...
                           41133 44142;...
                           61202 64219];
        tempPoints.nRates = 2; 
        tempPoints.rates = [-0.5, 0.5]; 
        tempPoints.threshLow = 16.5;
        tempPoints.threshHigh = 25.5;   
    case 'linear_ramp_M_25-17'
        tempPoints.hold = [2056 18085;...
                           29578 44032;...
                           55420 69845];
        tempPoints.down = [18086 23830;...
                           44033 49853;...
                           69846 75633];
        tempPoints.up =   [23831 29577;...
                           49854 55419;...
                           75634 81411];
        tempPoints.nRates = 2; 
        tempPoints.rates = [-0.25, 0.25]; 
        tempPoints.threshLow = 16.5;
        tempPoints.threshHigh = 25.5; 
    case 'linear_ramp_XS_25-17'
        tempPoints.hold = [3864 18180; 63980 78830];
        tempPoints.down = [18181 41450; 78831 101900];
        tempPoints.up =   [41451 63979; 101901 124799];
        tempPoints.nRates = 2; 
        tempPoints.rates = [-0.061, 0.061]; 
        tempPoints.threshLow = 16.5;
        tempPoints.threshHigh = 25.5;   
   
    % ========================================
    case {'linear_ramp_with_recovery_23-15','linear_ramp_with_recovery_23-15 '}
        tempPoints.hold = [1058 10917;...
                           33841 48388;...
                           71281 85553;...
                           108700 123235;...
                           145828 159935];
        tempPoints.down = [10918 22513;...
                           48389 59742;...
                           85554 97281;...
                           123236 134476];
        tempPoints.up =   [22514 33840;...
                           59743 71280;...
                           97282 108699;...
                           134477 145827];
        tempPoints.nRates = 2; 
        tempPoints.rates = [-0.125, 0.125]; % added zero for hold times... errors in 3.1 w/out 0 ... errors in 2.1 w/ 0
        tempPoints.threshLow = 14.5;
        tempPoints.threshHigh = 23.5;  
    case 'linear_ramp_with_recovery_25-17'
        tempPoints.hold = [1058 10917;...
                           33841 48388;...
                           71281 85553;...
                           108700 123235;...
                           145828 159935];
        tempPoints.down = [10918 22513;...
                           48389 59742;...
                           85554 97281;...
                           123236 134476];
        tempPoints.up =   [22514 33840;...
                           59743 71280;...
                           97282 108699;...
                           134477 145827];
        tempPoints.nRates = 2; 
        tempPoints.rates = [-0.125, 0.125]; % added zero for hold times... errors in 3.1 w/out 0 ... errors in 2.1 w/ 0
        tempPoints.threshLow = 16.5;
        tempPoints.threshHigh = 25.5;  
    case 'linear_ramp_with_recovery_27-19'
        tempPoints.hold = [1058 10917;...
                           33841 48388;...
                           71281 85553;...
                           108700 123235;...
                           145828 159935];
        tempPoints.down = [10918 22513;...
                           48389 59742;...
                           85554 97281;...
                           123236 134476];
        tempPoints.up =   [22514 33840;...
                           59743 71280;...
                           97282 108699;...
                           134477 145827];
        tempPoints.nRates = 2; 
        tempPoints.rates = [-0.125, 0.125]; % added zero for hold times... errors in 3.1 w/out 0 ... errors in 2.1 w/ 0
        tempPoints.threshLow = 18.5;
        tempPoints.threshHigh = 27.5;  
    case 'linear_ramp_with_recovery_21-13'
        tempPoints.hold = [1058 10917;...
                           33841 48388;...
                           71281 85553;...
                           108700 123235;...
                           145828 159935];
        tempPoints.down = [10918 22513;...
                           48389 59742;...
                           85554 97281;...
                           123236 134476];
        tempPoints.up =   [22514 33840;...
                           59743 71280;...
                           97282 108699;...
                           134477 145827];
        tempPoints.nRates = 2; 
        tempPoints.rates = [-0.125, 0.125]; % added zero for hold times... errors in 3.1 w/out 0 ... errors in 2.1 w/ 0
        tempPoints.threshLow = 12.5;
        tempPoints.threshHigh = 21.5;  
     % =======================================
    case 'Hold25C'
        tempPoints.hold = [10, 64275];
         tempPoints.down = [];
         tempPoints.up = [];
         tempPoints.nRates = 1; 
        tempPoints.rates = 0;
        tempPoints.threshLow = 24.5;
        tempPoints.threshHigh = 25.5;  

    % =======================================                   
    case 'eaton_cooling_warming_ramp'
        tempPoints.down = [5700,34799];
        tempPoints.up =   [34800,64000];
    case 'eaton_warming_cooling_ramp'
        tempPoints.down = [34800,64000];
        tempPoints.up =   [5700,34799];
    % =======================================
      case 'single_step_down_23-13'
        tempPoints.hold = [515, 10714;...
                           12727, 19804;...
                           21506, 52899;...
                           55292, 61895;...
                           63822, 95161;...
                           97605, 104230;...
                           106134, 138785];
        tempPoints.down = [];
        tempPoints.up =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0;
        tempPoints.threshLow = 23.5;
        tempPoints.threshHigh = 12.5;  
        case 'single_step_down_23-15'
        tempPoints.hold = [515, 10714;...
                           12727, 19804;...
                           21506, 52899;...
                           55292, 61895;...
                           63822, 95161;...
                           97605, 104230;...
                           106134, 138785];
        tempPoints.down = [];
        tempPoints.up =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0;
        tempPoints.threshLow = 23.5;
        tempPoints.threshHigh = 12.5;  
    
    
    % =============Step protocols============
    case 'Step_ramp_down'
        tempPoints.hold = [184,8059;...
                           9661, 17138;...
                           19790, 26110;...
                           27681, 35024;...
                           36996, 44059;...
                           46028, 52935;...
                           54854, 62009;...
                           63940, 70766];
        tempPoints.down = [];
        tempPoints.up =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0;
        tempPoints.threshLow = 10;
        tempPoints.threshHigh = 20;

    case 'Step_ramp_up 23-10'
        tempPoints.hold = [184,8059;...
                           9661, 17138;...
                           19790, 26110;...
                           27681, 35024;...
                           36996, 44059;...
                           46028, 52935;...
                           54854, 62009;...
                           63940, 70766];
        tempPoints.down = [];
        tempPoints.up =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0;
        tempPoints.threshLow = 10;
        tempPoints.threshHigh = 23;

    case 'Step_ramp_down 23-10'
        tempPoints.hold = [184,8059;...
                           9661, 17138;...
                           19790, 26110;...
                           27681, 35024;...
                           36996, 44059;...
                           46028, 52935;...
                           54854, 62009;...
                           63940, 70766];
        tempPoints.down = [];
        tempPoints.up =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0;
        tempPoints.threshLow = 10;
        tempPoints.threshHigh = 23;
    case 'Vibrating Single Step 23-15'
        tempPoints.hold = [665,32994;...
                           34416, 42822;...
                           44395, 76724;...
                           78356, 86553;...
                           88367, 120454;...
                           122086, 136275];
        tempPoints.down = [];
        tempPoints.up =   [];
        tempPoints.nRates = 1; 
        tempPoints.rates = 0;
        tempPoints.threshLow = 10;
        tempPoints.threshHigh = 25;
    % =======================================    
    case 'double_linear_cooling_ramp'
        tempPoints.down = [5549,23510;...
                           52221,70330;...
                           98831,117100];
        tempPoints.up =   [28871, 46850;...
                           75571,93480;...
                           122401,140399];
        tempPoints.hold = [23511 28870;...
                           46851 52220;...
                           70331 75570;...
                           93481 98830;...
                           117101 122400;...
                           140400 148300];
       tempPoints.nRates = 3; % -0.25,0, 0.25
       tempPoints.rates = [-0.25,0,0.25];
       tempPoints.threshLow = 5;
       tempPoints.threshHigh = 30;
    case 'double_linear_heating_ramp'
        tempPoints.up =   [5549,23510;...
                           52221,70330;...
                           98831,117100];
        tempPoints.down = [28871, 46850;...
                           75571,93480;...
                           122401,140399];
        tempPoints.hold = [23511 28870;...
                           46851 52220;...
                           70331 75570;...
                           93481 98830;...
                           117101 122400;...
                           140400 148300];   
        tempPoints.nRates = 3; % -0.25,0, 0.25\
        tempPoints.rates = [-0.25,0,0.25];
    case 'Expanding Ramps Up'
        tempPoints.hold = [];
        tempPoints.up =   [2174 7445;...
                           16281 29840;...
                           49170 71850;...
                           98991 134500];
        tempPoints.down = [7446 16280;...
                           28941 47790;...
                           71851 98990];
        tempPoints.nRates = 2;
        tempPoints.rates = [-0.16, 0.16]; 
        tempPoints.threshLow = 6;
        tempPoints.threshHigh = 34;
    case 'slow_looping_ramps_up_12_22'
        tempPoints.hold = [];
        tempPoints.up =   [13680 31560;...
                           49611 67720;...
                           85501 103600;...
                           121401 139400];
        tempPoints.down = [31561 49610;...
                           67721 85500;...
                           103601 121400];
        tempPoints.nRates = 2;
        tempPoints.rates = [-0.1, 0.1]; 
        tempPoints.threshLow = 12;
        tempPoints.threshHigh = 22;

    case 'looping_ramps_13_25'
        tempPoints.hold = [];
        tempPoints.up =   [20059 37327;...
                           54309 72032;...
                           89278 106492;...
                           123512 104581];
        tempPoints.down = [3155 20058;...
                           37328 54608;...
                           72033 89277;...
                           106493 123511];
        tempPoints.nRates = 2;
        tempPoints.rates = [-0.1, 0.1]; 
        tempPoints.threshLow = 13;
        tempPoints.threshHigh = 25;
    % =======================================  
    case 'Velocity Ramp A Up'
        tempPoints.hold = [];
        tempPoints.up =   [2924, 19150;...
                           51340,64090;... 
                           77100,83630;... 
                           90200,122500];
        tempPoints.down = [19151,51339;... 
                           64091,77099;... 
                           83631,90199;... 
                           122501,154500];
        tempPoints.nRates = 7;
%         tempPoints.rates = [-0.5, -0.25, -0.1, 0, 0.1, 0.25, 0.5]; 
        tempPoints.rates = [-0.5, -0.25, -0.1, 0.1, 0.25, 0.5]; 
        tempPoints.threshLow = 6;
        tempPoints.threshHigh = 25;
    case 'Velocity Ramp B Up'
        tempPoints.hold = [];
        tempPoints.up =   [2371 19210;...
                           51260 57720;...
                           64240 77290;...
                           90230 122500];
        tempPoints.down = [19211 51259;...
                           57721 64239;...
                           77291 90229;...
                           122501 154500];
        tempPoints.nRates = 7;
        %         tempPoints.rates = [-0.5, -0.25, -0.1, 0, 0.1, 0.25, 0.5]; 
        tempPoints.rates = [-0.5, -0.25, -0.1, 0.1, 0.25, 0.5]; 
        tempPoints.threshLow = 6;
        tempPoints.threshHigh = 25;
    case 'Velocity Ramp C Up'
        tempPoints.hold = [];
        tempPoints.up =   [2853 9312;...
                           22276 54513;...
                           86805 93305;...
                           99884 112443];
        tempPoints.down = [9313 22275;...
                           54514 86804;...
                           93306 99883;...
                           112744 125577];
        tempPoints.nRates = 7;
        %         tempPoints.rates = [-0.5, -0.25, -0.1, 0, 0.1, 0.25, 0.5]; 
        tempPoints.rates = [-0.5, -0.25, -0.1, 0.1, 0.25, 0.5]; 
        tempPoints.threshLow = 6;
        tempPoints.threshHigh = 25;
    case 'Velocity Ramp D Up'
        tempPoints.up =   [2864 9338;...
                           22217 28625;...
                           35259 67423;...
                           99839 112803];
        tempPoints.down = [9339 22216;...
                           28626 35258;...
                           67424 99838;...
                           112804 125516];
        tempPoints.hold = [];
        tempPoints.nRates = 7;
        %         tempPoints.rates = [-0.5, -0.25, -0.1, 0, 0.1, 0.25, 0.5]; 
        tempPoints.rates = [-0.5, -0.25, -0.1, 0.1, 0.25, 0.5]; 
        tempPoints.threshLow = 6;
        tempPoints.threshHigh = 25;
    case 'Velocity Ramp E Up'
        tempPoints.up =   [2781 6005;...
                           12570 45089;...
                           77070 90129;...
                           103000 109399];
        tempPoints.down = [6006 12569;...
                           45090 77069;...
                           90130 102999;
                           109400 115800];
        tempPoints.hold = [];
        tempPoints.nRates = 7;
        %         tempPoints.rates = [-0.5, -0.25, -0.1, 0, 0.1, 0.25, 0.5]; 
        tempPoints.rates = [-0.5, -0.25, -0.1, 0.1, 0.25, 0.5]; 
        tempPoints.threshLow = 6;
        tempPoints.threshHigh = 25;
    case 'Velocity Ramp F Up'
        tempPoints.up =   [2809 6016;...
                           12604 25504;...
                           38442 70725;...
                           102912 109415];
        tempPoints.down = [6017 12603;...
                           25505 38441;...
                           70726 102911;...
                           109416 115806];
        tempPoints.hold = [];
        tempPoints.nRates = 7;
        tempPoints.rates = [-0.5, -0.25, -0.1, 0, 0.1, 0.25, 0.5];
        tempPoints.threshLow = 6;
        tempPoints.threshHigh = 25;
    % ======================================= 
    case 'giant_ramp_10_30'
        tempPoints.up = [8871, 38791;...
                         68707, 98766];
        tempPoints.down = [38792, 68706;...
                           98767, 128662];
        tempPoints.hold = [];
        tempPoints.nRates = 2;
        tempPoints.rates = [-0.15, 0.15];
        tempPoints.threshLow = 10;
        tempPoints.threshHigh = 35;
    case 'looping_ramps_up'
        tempPoints.up =   [2810 11924;...
                           29826 47748;...
                           65705 83597;...
                           101612 119747];
        tempPoints.down = [11925 29825;...
                           47749 65704;...
                           83598 101611];
        tempPoints.hold = [];
        tempPoints.nRates = 2;
        tempPoints.rates = [-0.16, 0.16];
        tempPoints.threshLow = 7;
        tempPoints.threshHigh = 23;
    case 'looping_ramps_up_10_26'
        tempPoints.up =   [2810 11924;...
                           29826 47748;...
                           65705 83597;...
                           101612 119747];
        tempPoints.down = [11925 29825;...
                           47749 65704;...
                           83598 101611];
        tempPoints.hold = [];
        tempPoints.nRates = 2;
        tempPoints.rates = [-0.16, 0.16];
        tempPoints.threshLow = 10;
        tempPoints.threshHigh = 26;
    case 'looping_ramps_down'
        tempPoints.down =   [2810 11924;...
                           29826 47748;...
                           65705 83597;...
                           101612 119747];
        tempPoints.up = [11925 29825;...
                           47749 65704;...
                           83598 101611];
        tempPoints.hold = [];
        tempPoints.nRates = 2;
        tempPoints.rates = [-0.16, 0.16];
        tempPoints.threshLow = 7;
        tempPoints.threshHigh = 23;
    case 'frequency_sweeps_12'
        tempPoints.down = [8947       11315;...
                           13506       15908;...
                           18538       20714;...
                           23111       25536;...
                           28100       30264;...
                           32649       35082;...
                           37486       40064;...
                           42325       44755;...
                           47109       49557;...
                           51937       54470;...
                           56866       59131;...
                           61419       64009;...
                           66476       68754;...
                           69849       71038;...
                           72225       73422;...
                           74717       75809;...
                           77017       78277;...
                           79386       80705;...
                           81913       82994;...
                           84315       85360;...
                           86701       87937;...
                           88985       90206;...
                           91488       92710;...
                           93777       95066;...
                           96135       97493;...
                           98646       99784;...
                          100426      101028;...
                          101557      102239;...
                          102762      103437;...
                          103960      104624;...
                          105214      105768;...
                          106464      107047;...
                          107554      108230;...
                          108752      109427;...
                          109982      110587;...
                          111160      111761;...
                          112346      112992;...
                          113544      114220;...
                          114727      115343];
        tempPoints.up = [6440        8946;...
                       11316       13505;...
                       15909       18537;...
                       20715       23110;...
                       25537       28099;...
                       30265       32648;...
                       35083       37485;...
                       40065       42324;...
                       44756       47108;...
                       49558       51936;...
                       54471       56865;...
                       59132       61418;...
                       64010       66475;...
                       68755       69848;...
                       71039       72224;...
                       73423       74716;...
                       75810       77016;...
                       78278       79385;...
                       80706       81912;...
                       82995       84314;...
                       85361       86700;...
                       87938       88984;...
                       90207       91487;...
                       92711       93776;...
                       95067       96134;...
                       97494       98645;...
                       99785      100425;...
                      101029      101556;...
                      102240      102761;...
                      103438      103959;...
                      104625      105213;...
                      105769      106463;...
                      107048      107553;...
                      108231      108751;...
                      109428      109981;...
                      110588      111159;...
                      111762      112345;...
                      112993      113543;...
                      114221      114726];
        tempPoints.hold = [];
        tempPoints.rates = [-.65, -0.3, -0.15, 0.15, 0.30, 0.65];
        tempPoints.nRates = 6;
        tempPoints.threshLow = 11;
        tempPoints.threshHigh = 13;
    case 'frequency_sweeps_18'
        tempPoints.down = [6333        8818;...
                           11222       13793;...
                           15952       18405;...
                           20897       23347;...
                           25521       27900;...
                           30294       32707;...
                           35097       37469;...
                           39869       42261;...
                           44870       47083;...
                           49633       51891;...
                           54473       56652;...
                           59049       61672;...
                           63927       66303;...
                           68745       69936;...
                           71105       72196;...
                           73412       74754;...
                           75929       77020;...
                           78228       79567;...
                           80734       81931;...
                           82997       84203;...
                           85390       86572;...
                           87819       88945;...
                           90242       91529;...
                           92671       93887;...
                           95005       96156;...
                           97370       98704;...
                           99761      100386;...
                          100964      101579;...
                          102237      102760;...
                          103378      103983;...
                          104622      105151;...
                          105817      106356;...
                          106954      107552;...
                          108170      108782;...
                          109335      109970;...
                          110560      111143;...
                          111823      112368;...
                          112929      113570;...
                          114165      114754;...
                          115339      115894];
        tempPoints.up =[8819       11221;...
                       13794       15951;...
                       18406       20896;...
                       23348       25520;...
                       27901       30293;...
                       32708       35096;...
                       37470       39868;...
                       42262       44869;...
                       47084       49632;...
                       51892       54472;...
                       56653       59048;...
                       61673       63926;...
                       66304       68744;...
                       69937       71104;...
                       72197       73411;...
                       74755       75928;...
                       77021       78227;...
                       79568       80733;...
                       81932       82996;...
                       84204       85389;...
                       86573       87818;...
                       88946       90241;...
                       91530       92670;...
                       93888       95004;...
                       96157       97369;...
                       98705       99760;...
                      100387      100963;...
                      101580      102236;...
                      102761      103377;...
                      103984      104621;...
                      105152      105816;...
                      106357      106953;...
                      107553      108169;...
                      108783      109334;...
                      109971      110559;...
                      111144      111822;...
                      112369      112928;...
                      113571      114164;...
                      114755      115338];
        tempPoints.hold = [];
        tempPoints.rates = [-.65, -0.3, -0.15, 0.15, 0.30, 0.65];
        tempPoints.nRates = 6;
        tempPoints.threshLow = 17;
        tempPoints.threshHigh = 19;
    case 'looping_ramps_up_14_22'
        tempPoints.up =  [7240 16500;...
                          25460 34220;...
                          43390 52390;...
                          61150 70320;...
                          79360 88330;...
                          97290 106200;...
                          115000 124200];
        tempPoints.down = [2766 7239;...
                           16501 25459;...
                           34221 43389;...
                           52391 61149;...
                           70321 79359;...
                           88331 97289;...
                           106201 114999;...
                           124201 132900];
        tempPoints.hold = [];
        tempPoints.nRates = 2;
        tempPoints.rates = [-0.16, 0.16];
        tempPoints.threshLow = 14;
        tempPoints.threshHigh = 22;
         % =======================================
        case 'double_eaton_cooling_warming_ramp'
            tempPoints.down = [5720,34628;...
                               64819,93739];
            tempPoints.up =   [34629,64818;...
                               93740,141259];
                           
        case 'double_eaton_warming_cooling_ramp'
            tempPoints.up =   [5720,34628;...
                               64819,93739];
            tempPoints.down = [34629,64818;...
                               93740,141259];
        
end

% increasing|decreasing ROI:
nUp = size(tempPoints.up,1);
nDown = size(tempPoints.down,1);
nHold = size(tempPoints.hold,1);
tempPoints.nUp = nUp;
tempPoints.nDown = nDown;
tempPoints.nHold = nHold;
UpROI = [];
for ii = 1:nUp
    roi = tempPoints.up(ii,1):tempPoints.up(ii,2);
    UpROI = [UpROI,roi];
end
DownROI = [];
for ii = 1:nDown
    roi = tempPoints.down(ii,1):tempPoints.down(ii,2);
    DownROI = [DownROI,roi];
end
HoldROI = [];
for ii = 1:nHold
    roi = tempPoints.hold(ii,1):tempPoints.hold(ii,2);
    HoldROI = [HoldROI,roi];
end
tempPoints.UpROI = UpROI;
tempPoints.DownROI = DownROI;
tempPoints.HoldROI = HoldROI;
tempPoints.nRates = length(tempPoints.rates);

% just pull all the points where the temp ramp changes rate:

temp = [tempPoints.up; tempPoints.down; tempPoints.hold];
% temp = [1; sort(temp(:))];
temp = sort(temp(:)); % white background adjustment
loc = diff(temp)<10;
temp(loc) = [];
tempPoints.transitions = temp;





